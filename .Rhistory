# Task 5
forward_mid <- DNAString("ACGAGTGCGT")
backward_mid <- reverseComplement(forward_mid)
forward_mid <- as.character(forward_mid)
backward_mid <- as.character(backward_mid)
dna_text <- as.character(dna)
pattern <- paste0(forward_mid, ".*?", backward_mid)
matched_seq <- regmatches(dna_text, gregexpr(pattern, dna_text, perl = TRUE))
number_of_matches <- lengths(matched_seq) > 0
sum(number_of_matches)
library(data.table)
mid <- read.csv2("fishes_MIDs.csv")
for_mid <- mid$FBarcodeSequence # dopredne MIDs
bac_mid <- mid$RBarcodeSequence # zpetne MIDs
# převod bac_mid na reverse complement
bac_mid <- sapply(bac_mid, function(x) as.character(reverseComplement(DNAString(x))))
sample_labels <- mid$SampleID # labels
Demultiplexer <- function(path, for_mid, bac_mid, sample_labels){
dna <- readDNAStringSet(path)
if (is.null(names(dna))) names(dna) <- paste0("seq", seq_along(dna))
outdir <- "cut_from_MIDs"
if (!dir.exists(outdir)) dir.create(outdir)
counts <- setNames(integer(length(sample_labels)), sample_labels)
output_sets <- setNames(vector("list", length(sample_labels)), sample_labels)
for (s in sample_labels) output_sets[[s]] <- DNAStringSet()
starts_with <- function(seq, prefix) substr(seq, 1, nchar(prefix)) == prefix
ends_with   <- function(seq, suffix) substr(seq, nchar(seq)-nchar(suffix)+1, nchar(seq)) == suffix
for (i in seq_along(dna)){
seq_char <- as.character(dna[[i]])
seq_name <- names(dna)[i]
idx <- which(starts_with(seq_char, for_mid) & ends_with(seq_char, bac_mid))
if (length(idx) == 1) {
fwd <- for_mid[idx]
rev <- bac_mid[idx]
trimmed <- substr(seq_char, nchar(fwd)+1, nchar(seq_char)-nchar(rev))
# opravené přiřazení jména sekvence
seq_set <- DNAStringSet(trimmed)
names(seq_set) <- seq_name
output_sets[[ sample_labels[idx] ]] <- c(
output_sets[[ sample_labels[idx] ]],
seq_set
)
counts[idx] <- counts[idx] + 1
}
}
for (s in sample_labels) {
if (length(output_sets[[s]]) > 0) {
writeXStringSet(output_sets[[s]], file.path(outdir, paste0(s, ".fasta")))
}
}
report <- data.table(Sample = sample_labels, Count = counts)
fwrite(report, file.path(outdir, "report.txt"), sep="\t")
return(report)
}
Demultiplexer("fishes.fna.gz", for_mid, bac_mid, sample_labels)
# Task 6
library(data.table)
mid <- read.csv2("fishes_MIDs.csv")
for_mid <- mid$FBarcodeSequence # dopredne MIDs
bac_mid <- mid$RBarcodeSequence # zpetne MIDs
# převod bac_mid na reverse complement
bac_mid <- sapply(bac_mid, function(x) as.character(reverseComplement(DNAString(x))))
sample_labels <- mid$SampleID # labels
Demultiplexer <- function(path, for_mid, bac_mid, sample_labels){
dna <- readDNAStringSet(path)
if (is.null(names(dna))) names(dna) <- paste0("seq", seq_along(dna))
outdir <- "cut_from_MIDs"
if (!dir.exists(outdir)) dir.create(outdir)
counts <- setNames(integer(length(sample_labels)), sample_labels)
output_sets <- setNames(vector("list", length(sample_labels)), sample_labels)
for (s in sample_labels) output_sets[[s]] <- DNAStringSet()
starts_with <- function(seq, prefix) substr(seq, 1, nchar(prefix)) == prefix
ends_with   <- function(seq, suffix) substr(seq, nchar(seq)-nchar(suffix)+1, nchar(seq)) == suffix
for (i in seq_along(dna)){
seq_char <- as.character(dna[[i]])
seq_name <- names(dna)[i]
idx <- which(starts_with(seq_char, for_mid) & ends_with(seq_char, bac_mid))
if (length(idx) == 1) {
fwd <- for_mid[idx]
rev <- bac_mid[idx]
trimmed <- substr(seq_char, nchar(fwd)+1, nchar(seq_char)-nchar(rev))
# opravené přiřazení jména sekvence
seq_set <- DNAStringSet(trimmed)
names(seq_set) <- seq_name
output_sets[[ sample_labels[idx] ]] <- c(
output_sets[[ sample_labels[idx] ]],
seq_set
)
counts[idx] <- counts[idx] + 1
}
}
for (s in sample_labels) {
if (length(output_sets[[s]]) > 0) {
writeXStringSet(output_sets[[s]], file.path(outdir, paste0(s, ".fasta")))
}
}
report <- data.table(Sample = sample_labels, Count = counts)
fwrite(report, file.path(outdir, "report.txt"), sep="\t")
return(report)
}
Demultiplexer("fishes.fna.gz", for_mid, bac_mid, sample_labels)
# Task 6
library(data.table)
mid <- read.csv2("fishes_MIDs.csv")
for_mid <- mid$FBarcodeSequence # dopredne MIDs
bac_mid <- mid$RBarcodeSequence # zpetne MIDs
# převod bac_mid na reverse complement
bac_mid <- sapply(bac_mid, function(x) as.character(reverseComplement(DNAString(x))))
sample_labels <- mid$SampleID # labels
Demultiplexer <- function(path, for_mid, bac_mid, sample_labels){
dna <- readDNAStringSet(path)
if (is.null(names(dna))) names(dna) <- paste0("seq", seq_along(dna))
outdir <- "cut_from_MIDs"
if (!dir.exists(outdir)) dir.create(outdir)
counts <- setNames(integer(length(sample_labels)), sample_labels)
output_sets <- setNames(vector("list", length(sample_labels)), sample_labels)
for (s in sample_labels) output_sets[[s]] <- DNAStringSet()
starts_with <- function(seq, prefix) substr(seq, 1, nchar(prefix)) == prefix
ends_with   <- function(seq, suffix) substr(seq, nchar(seq)-nchar(suffix)+1, nchar(seq)) == suffix
for (i in seq_along(dna)){
seq_char <- as.character(dna[[i]])
seq_name <- names(dna)[i]
idx <- which(starts_with(seq_char, for_mid) & ends_with(seq_char, bac_mid))
if (length(idx) == 1) {
fwd <- for_mid[idx]
rev <- bac_mid[idx]
trimmed <- substr(seq_char, nchar(fwd)+1, nchar(seq_char)-nchar(rev))
# opravené přiřazení jména sekvence
seq_set <- DNAStringSet(trimmed)
names(seq_set) <- seq_name
output_sets[[ sample_labels[idx] ]] <- c(
output_sets[[ sample_labels[idx] ]],
seq_set
)
counts[idx] <- counts[idx] + 1
}
}
for (s in sample_labels) {
if (length(output_sets[[s]]) > 0) {
writeXStringSet(output_sets[[s]], file.path(outdir, paste0(s, ".fasta")))
}
}
report <- data.table(Sample = sample_labels, Count = counts)
fwrite(report, file.path(outdir, "report.txt"), sep="\t")
return(report)
}
Demultiplexer("fishes.fna.gz", for_mid, bac_mid, sample_labels)
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
rm(list=ls()) #clean, clc, close all
# ***************
# R version 4.4.2 / win
# author: Nikola Jordánová
# *************
# Path
# setwd('V:/MPA-PRG/exercise_02') # set working directory
setwd('C:/Users/nikol/School/MPA-PRG/exercise_02')
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
# Task 1
dna <- readDNAStringSet("fishes.fna.gz")
library(Biostrings)
# Task 1
dna <- readDNAStringSet("fishes.fna.gz")
rm(list=ls()) #clean, clc, close all
library(Biostrings)
library(seqinr)
library(stringr)
dna
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
library(Biostrings)
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
dna <- readDNAStringSet("fishes.fna.gz")
dna
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
rm(list=ls()) #clean, clc, close all
# ***************
# R version 4.4.2 / win
# author: Nikola Jordánová
# *************
# Path
# setwd('V:/MPA-PRG/exercise_02') # set working directory
setwd('C:/Users/nikol/School/MPA-PRG/exercise_02')
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
a
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
dna
# Task 2
length(dna) # pocet sekvenci
# Task 3
BiocManager::install("pwalign")
library(pwalign)
sequence1 <- dna[[1]]
sequence1
sequence2 <- dna[[2]]
aa1 <- AAString(as.character(sequence1))
aa2 <- AAString(as.character(sequence2))
aa1
mat <- pairwiseAlignment(pattern = aa1, subject = aa2, substitutionMatrix = "BLOSUM62", gapOpening = -1, gapExtension = 1, type = "global")
mat
# Task 5
forward_mid <- DNAString("ACGAGTGCGT")
backward_mid <- reverseComplement(forward_mid)
forward_mid <- as.character(forward_mid)
backward_mid <- as.character(backward_mid)
forward_mid
dna_text <- as.character(dna)
pattern <- paste0(forward_mid, ".*?", backward_mid)
matched_seq <- regmatches(dna_text, gregexpr(pattern, dna_text, perl = TRUE))
number_of_matches <- lengths(matched_seq) > 0
sum(number_of_matches)
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#
# BiocManager::install("Biostrings")
#
library(Biostrings)
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
View(forward_mid)
forward_mid
View(matched_seq)
View(matched_seq)
# Task 6
Demultiplexer <- function(fasta_path, forward_MIDs, reverse_MIDs, sample_labels) {
# fasta_path - a string with path to fasta file
# forward_MIDs - a list of forward MIDs
# reverse_MIDs - a list of reverse MIDs
# sample_labels - a list of samples labels
# Načtení FASTA souboru
dna <- readDNAStringSet(fasta_path)
dna_names <- names(dna)
dna_seq <- as.character(dna)
# === 3. Inicializuj datové struktury ===
n_samples <- length(sample_labels)
counts <- integer(n_samples)  # počítadlo sekvencí na vzorek
# === 4. Pro každý vzorek: najdi sekvence a ořež MIDs ===
for (i in seq_len(n_samples)) {
fwd <- as.character(DNAString(forward_MIDs[i]))
rev <- as.character(reverseComplement(DNAString(reverse_MIDs[i])))
# Vytvoř regex: fwd ... rev (nejkratší možný match)
pattern <- paste0(fwd, ".*?", rev)
# Najdi sekvence s oběma MIDs
matches <- grepl(pattern, dna_seq, perl = TRUE)
selected <- dna_seq[matches]
if (length(selected) == 0) next
# Ořež MIDs (vystřihni jen mezi nimi)
trimmed <- gsub(paste0("^", fwd, "(.*?)", rev, "$"), "\\1", selected, perl = TRUE)
# Ulož FASTA soubor pro tento vzorek
output_fasta <- paste0(sample_labels[i], ".fasta")
writeXStringSet(DNAStringSet(trimmed), filepath = output_fasta)
counts[i] <- length(trimmed)
cat("→", sample_labels[i], ":", counts[i], "sekvencí\n")
}
# === 5. Ulož report ===
report <- data.frame(
Sample = sample_labels,
ForwardMID = forward_MIDs,
ReverseMID = reverse_MIDs,
Sequences = counts
)
write.table(report, file = "report.txt", sep = "\t", quote = FALSE, row.names = FALSE)
cat("\nHotovo! Report uložen jako 'report.txt'\n")
invisible(report)
}
path <- "fishes.fna.gz"
mids <- read_csv("fishes_MIDs.csv")
# Task 6
Demultiplexer <- function(fasta_path, forward_MIDs, reverse_MIDs, sample_labels) {
# fasta_path - a string with path to fasta file
# forward_MIDs - a list of forward MIDs
# reverse_MIDs - a list of reverse MIDs
# sample_labels - a list of samples labels
# Načtení FASTA souboru
dna <- readDNAStringSet(fasta_path)
dna_names <- names(dna)
dna_seq <- as.character(dna)
# === 3. Inicializuj datové struktury ===
n_samples <- length(sample_labels)
counts <- integer(n_samples)  # počítadlo sekvencí na vzorek
# === 4. Pro každý vzorek: najdi sekvence a ořež MIDs ===
for (i in seq_len(n_samples)) {
fwd <- as.character(DNAString(forward_MIDs[i]))
rev <- as.character(reverseComplement(DNAString(reverse_MIDs[i])))
# Vytvoř regex: fwd ... rev (nejkratší možný match)
pattern <- paste0(fwd, ".*?", rev)
# Najdi sekvence s oběma MIDs
matches <- grepl(pattern, dna_seq, perl = TRUE)
selected <- dna_seq[matches]
if (length(selected) == 0) next
# Ořež MIDs (vystřihni jen mezi nimi)
trimmed <- gsub(paste0("^", fwd, "(.*?)", rev, "$"), "\\1", selected, perl = TRUE)
# Ulož FASTA soubor pro tento vzorek
output_fasta <- paste0(sample_labels[i], ".fasta")
writeXStringSet(DNAStringSet(trimmed), filepath = output_fasta)
counts[i] <- length(trimmed)
cat("→", sample_labels[i], ":", counts[i], "sekvencí\n")
}
# === 5. Ulož report ===
report <- data.frame(
Sample = sample_labels,
ForwardMID = forward_MIDs,
ReverseMID = reverse_MIDs,
Sequences = counts
)
write.table(report, file = "report.txt", sep = "\t", quote = FALSE, row.names = FALSE)
cat("\nHotovo! Report uložen jako 'report.txt'\n")
invisible(report)
}
library(readr)
path <- "fishes.fna.gz"
mids <- read_csv("fishes_MIDs.csv")
forward_MIDs = mids$FBarcodeSequence
reverse_MIDs = mids$RBarcodeSequence
sample_labels = mids$SampleID
Demultiplexer(path, forward_MIDs, reverse_MIDs, sample_labels)
rm(list=ls()) #clean, clc, close all
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#
# BiocManager::install("Biostrings")
#
library(Biostrings)
path <- "fishes.fna.gz"
mids <- read_csv("fishes_MIDs.csv")
View(mids)
forward_MIDs = mids$FBarcodeSequence
View(mids)
mids <- read.csv("fishes_MIDs.csv", sep = ";", stringsAsFactors = FALSE)
View(mids)
forward_MIDs = mids$FBarcodeSequence
# Task 6
Demultiplexer <- function(fasta_path, forward_MIDs, reverse_MIDs, sample_labels) {
# fasta_path - a string with path to fasta file
# forward_MIDs - a list of forward MIDs
# reverse_MIDs - a list of reverse MIDs
# sample_labels - a list of samples labels
# Načtení FASTA souboru
dna <- readDNAStringSet(fasta_path)
dna_names <- names(dna)
dna_seq <- as.character(dna)
# === 3. Inicializuj datové struktury ===
n_samples <- length(sample_labels)
counts <- integer(n_samples)  # počítadlo sekvencí na vzorek
# === 4. Pro každý vzorek: najdi sekvence a ořež MIDs ===
for (i in seq_len(n_samples)) {
fwd <- as.character(DNAString(forward_MIDs[i]))
rev <- as.character(reverseComplement(DNAString(reverse_MIDs[i])))
# Vytvoř regex: fwd ... rev (nejkratší možný match)
pattern <- paste0(fwd, ".*?", rev)
# Najdi sekvence s oběma MIDs
matches <- grepl(pattern, dna_seq, perl = TRUE)
selected <- dna_seq[matches]
if (length(selected) == 0) next
# Ořež MIDs (vystřihni jen mezi nimi)
trimmed <- gsub(paste0("^", fwd, "(.*?)", rev, "$"), "\\1", selected, perl = TRUE)
# Ulož FASTA soubor pro tento vzorek
output_fasta <- paste0(sample_labels[i], ".fasta")
writeXStringSet(DNAStringSet(trimmed), filepath = output_fasta)
counts[i] <- length(trimmed)
cat("→", sample_labels[i], ":", counts[i], "sekvencí\n")
}
# === 5. Ulož report ===
report <- data.frame(
Sample = sample_labels,
ForwardMID = forward_MIDs,
ReverseMID = reverse_MIDs,
Sequences = counts
)
write.table(report, file = "report.txt", sep = "\t", quote = FALSE, row.names = FALSE)
cat("\nHotovo! Report uložen jako 'report.txt'\n")
invisible(report)
}
library(readr)
path <- "fishes.fna.gz"
mids <- read.csv("fishes_MIDs.csv", sep = ";", stringsAsFactors = FALSE)
forward_MIDs = mids$FBarcodeSequence
reverse_MIDs = mids$RBarcodeSequence
sample_labels = mids$SampleID
Demultiplexer(path, forward_MIDs, reverse_MIDs, sample_labels)
rm(list=ls()) #clean, clc, close all
# ***************
# R version 4.4.2 / win
# author: Nikola Jordánová
# *************
# Path
# setwd('V:/MPA-PRG/exercise_02') # set working directory
setwd('C:/Users/nikol/School/MPA-PRG/exercise_02')
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#
# BiocManager::install("Biostrings")
#
library(Biostrings)
library(readr)
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
View(aa1)
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
debugSource("C:/Users/nikol/School/MPA-PRG/exercise_02/lecture_02.R")
rm(list=ls()) #clean, clc, close all
# ***************
# R version 4.4.2 / win
# author: Nikola Jordánová
# *************
# Path
# setwd('V:/MPA-PRG/exercise_02') # set working directory
setwd('C:/Users/nikol/School/MPA-PRG/exercise_02')
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#
# BiocManager::install("Biostrings")
#
library(Biostrings)
dna <- readDNAStringSet("fishes.fna.gz")
dna
length(dna) # pocet sekvenci
width(dna[1]) # delka urcite sekvence
names(dna) # nazvy sekvenci (hlavicky)
seq1 <- dna[1] # prvni sekvence
seq1
seq1_sequence <- dna[[1]] # prvni sekvence, ale bez jmena
seq1_string <- toString(dna[1]) # prvni sekvence jako vektor
library(pwalign)
sequence1 <- dna[[1]]
sequence1
sequence2 <- dna[[2]]
aa1 <- AAString(as.character(sequence1))
aa2 <- AAString(as.character(sequence2))
aa1
mat <- pairwiseAlignment(pattern = aa1, subject = aa2, substitutionMatrix = "BLOSUM62", gapOpening = -1, gapExtension = 1, type = "global")
mat
# Task 4
names_list <- c("anna", "jana", "kamil", "norbert", "pavel", "petr", "stanislav", "zuzana") # vytvoreni listu
grep("jana", names_list, perl = TRUE) # vyhledavani
grep("n+", names_list, perl = TRUE) # najdi slova, ve kterych je alespon jednou pismeno n
grep("n{2}", names_list, perl = TRUE) # najdi slova, ve kterych je nn
grep("^n", names_list, perl = TRUE) # najdi slova, ktera zacinaji na n
grep("Anna|Jana", names_list, perl = TRUE) # najdi Anna nebo Jana
grep("^z.*a$", names_list, perl = TRUE) # najdi slova, ktera zacinaji na z a konci na a
# Task 5
forward_mid <- DNAString("ACGAGTGCGT")
backward_mid <- reverseComplement(forward_mid)
forward_mid <- as.character(forward_mid)
backward_mid <- as.character(backward_mid)
forward_mid
dna_text <- as.character(dna)
pattern <- paste0(forward_mid, ".*?", backward_mid)
matched_seq <- regmatches(dna_text, gregexpr(pattern, dna_text, perl = TRUE))
number_of_matches <- lengths(matched_seq) > 0
sum(number_of_matches)
rm(list=ls()) #clean, clc, close all
# ***************
# R version 4.4.2 / win
# author: Nikola Jordánová
# *************
# Path
# setwd('V:/MPA-PRG/exercise_03') # set working directory
setwd('C:/Users/nikol/School/MPA-PRG/exercise_03')
IndexOfMin <- function(array, first, last){
index <- first
for (k in (first + 1) : last){
if (array[k] < array[index]){
index <- k
}
}
return (index)
}
IndexOfMin(c(1,0,3,5,6), 1,4)
# SelectionSort
SelectionSort <- function(array, n){
for (i in 1 : (n - 1)){
j <- IndexOfMin(array, i, n)
array[c(i,j)] <- array[c(j,i)]
}
return (array)
}
array <- c(5,2,6,3,4)
n <- length(array)
SelectionSort(array,n)
# RecursiveSelectionSort
RecursiveSelectionSort <- function(array, first, last){
if (first <- last){
index <- IndexOfMin(array, first, last)
array[c(first,index)] <- array[c(index, first)]
array <- RecursiveSelectionSort(array, first + 1, last)
}
return (array)
}
array <- c(5,2,6,3,4)
first <- 1
last <- length(array)
RecursiveSelectionSort(array, first, last)
# RecursiveSelectionSort
RecursiveSelectionSort <- function(array, first, last){
if (first < last){
index <- IndexOfMin(array, first, last)
array[c(first,index)] <- array[c(index, first)]
array <- RecursiveSelectionSort(array, first + 1, last)
}
return (array)
}
array <- c(5,2,6,3,4)
first <- 1
last <- length(array)
RecursiveSelectionSort(array, first, last)
